System.register([],(function(){"use strict";return{execute:function(){System.register("project:///assets/scripts/planeNode.js",["cc"],(function(e,t){var i,o,s,a,n;return e({_dec:void 0,_class:void 0}),{setters:[function(e){i=e._decorator,o=e.Component}],execute:function(){cc._RF.push(window.module||{},"6beb0YkjhtHSL/AGQP96Qbm","planeNode"),n=i.ccclass,i.property,e("planeNode",(s=n("planeNode"),s(a=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"init",value:function(){this.deleting=!1}},{key:"delete",value:function(e){this.nodePool=e,this.deleting=!0,this._gravity=.01}},{key:"update",value:function(e){if(this.deleting){var t=this.node.getPosition();t.y-=this._gravity,this._gravity+=.002,this.node.setPosition(t),t.y<-2&&(this.nodePool.putPlaneNode(this.node),window._state_magr.deleteIndex=t.z)}}}]),t}(o))||a)),cc._RF.pop()}}})),System.register("project:///assets/scripts/rootNode.js",["cc","./data_con/pool_data.js","./manager/UI_magr.js","./manager/state_magr.js"],(function(e,t){var i,o,s,a,n,r,l,c,p,d,h,_,u,y,v,m,f,b,g,w,k,C;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,o=e.Component,s=e.SystemEvent,a=e.LabelComponent},function(e){n=e.pooldata},function(e){r=e.UImagr},function(e){l=e.statemagr}],execute:function(){cc._RF.push(window.module||{},"a4180/d/nZPA5phXQLFW87/","rootNode"),i.menu,k=i.ccclass,C=i.property,e("rootNode",(c=k("rootNode"),p=C({type:cc.Prefab}),d=C({type:cc.Node}),h=C({type:cc.Node}),_=C({type:cc.Node}),u=C({type:a}),c((v=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(s))),babelHelpers.initializerDefineProperty(i,"cubePrfb",m,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"player",f,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"leftNode",b,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"rightNode",g,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"scoreLabel",w,babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){this._existBlockArr=new Array,this._UI_Magr=new r,this._UI_Magr.startLoadRes(),window._state_magr=new l,window.Notification=new cc.EventTarget,window.Notification.on(window._state_magr.state._againGame,this.init,this),window.Notification.on(window._state_magr.state._gameOver,this.gameOver,this);for(var e=this.node.parent.children.length,t=0;t<e;t++)"Camera"==this.node.parent.children[t].name&&(this._camera=this.node.parent.children[t]);this.pool_data=new n,this.init(),this.leftNode.on(s.EventType.TOUCH_START,this.onLeftTouch,this),this.rightNode.on(s.EventType.TOUCH_START,this.onRightTouch,this)}},{key:"init",value:function(){for(;this._existBlockArr.length>0;){var e=this._existBlockArr.shift();this.pool_data.putPlaneNode(e)}this._updateTime=0,this._deleteBlockTime=60,this.lastBlock_x=0,window._state_magr.init(),this.scoreLabel.string="0",this.index=-5,this.pool_data.init(this.cubePrfb);for(var t=0;t<20;t++)this.addBlockNode();this.player.getComponent("playercon").init()}},{key:"updateScore",value:function(){window._state_magr._score++,this.scoreLabel.string=window._state_magr._score,this._deleteBlockTime>20&&(this._deleteBlockTime=45-Math.floor(window._state_magr._score/2))}},{key:"addBlockNode",value:function(){if(!window._state_magr._gameOver){this.index--;var e=this.pool_data.getPlaneNode();this.node.addChild(e),this._existBlockArr.push(e);var t=1*Math.random()>.5?1:-1;this.lastBlock_x=this.lastBlock_x+t,e.setPosition(this.lastBlock_x,0,this.index)}}},{key:"deleteBlock",value:function(){this._existBlockArr.length>0&&this._existBlockArr.shift().getComponent("planeNode").delete(this.pool_data)}},{key:"onLeftTouch",value:function(e){console.log("=======================点击事件  left"),window._state_magr._startGame?this.updateScore():window._state_magr._startGame=!0,this.player.getComponent("playercon").moveLeft(),this.addBlockNode()}},{key:"onRightTouch",value:function(e){console.log("=======================点击事件  right"),window._state_magr._startGame?this.updateScore():window._state_magr._startGame=!0,this.player.getComponent("playercon").moveRight(),this.addBlockNode()}},{key:"gameOver",value:function(){console.log("------------------收到游戏结束消息"),this._UI_Magr.addChildByName("overView")}},{key:"update",value:function(e){if(this._camera){var t=this.player.getPosition();this._camera.setPosition(cc.v3(t.x,3,t.z+8))}window._state_magr._startGame&&!window._state_magr._gameOver&&(this._updateTime++,this._updateTime>=this._deleteBlockTime&&(this._updateTime=0,this.deleteBlock()))}}]),t}(o),m=babelHelpers.applyDecoratedDescriptor(v.prototype,"cubePrfb",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=babelHelpers.applyDecoratedDescriptor(v.prototype,"player",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=babelHelpers.applyDecoratedDescriptor(v.prototype,"leftNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=babelHelpers.applyDecoratedDescriptor(v.prototype,"rightNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=babelHelpers.applyDecoratedDescriptor(v.prototype,"scoreLabel",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=v))||y)),cc._RF.pop()}}})),System.register("project:///assets/scripts/controllers/player_con.js",["cc"],(function(e,t){var i,o,s,a,n,r,l,c,p;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,o=e.Component,s=e.BoxColliderComponent,a=e.RigidBodyComponent,n=e.Vec3,r=e.tweenUtil}],execute:function(){cc._RF.push(window.module||{},"83ab3rK2b5EzLhMZ09aw9y+","player_con"),p=i.ccclass,i.property,e("playercon",(l=p("playercon"),l(c=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(s))))._action=!1,i._moveFinsh=!0,i._pos=new n(0,1.2,-5),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){this.alreadyStay=!0,this.player_collider=this.getComponent(s),this.init()}},{key:"init",value:function(){this.player_Body=this.getComponent(a),this._gravity=.008,this._pos=new n(0,1.2,-5),this.node.setPosition(new n(0,1.2,-5)),this.player_Body._useGravity=!0,this.player_Body._isKinematic=!1}},{key:"onCollision",value:function(e){if(console.log("-------------------碰撞"),"onCollisionStay"==e.type){if(this.alreadyStay)return;this.alreadyStay=!0,this._gravity=.008}else"onCollisionExit"==e.type&&(console.log("-------------------结束碰撞"),this.alreadyStay=!1)}},{key:"moveLeft",value:function(){var e=this;if(this._moveFinsh&&!window._state_magr._gameOver){this._moveFinsh=!1,this.scheduleOnce((function(){this._moveFinsh=!0}),.25);var t=this.node.getPosition();t.z-=1,t.x-=1,this._action=!0,this.player_Body._useGravity=!1,this.player_Body._isKinematic=!0,this.scheduleOnce((function(){this._action=!1,this.player_Body._useGravity=!0,this.player_Body._isKinematic=!1}),.15),n.copy(this._pos,this.node.getPosition()),r(this._pos).to(.1,new n(t.x,1.3,t.z),{easing:"easeIn",onUpdate:function(){e.node.position=e._pos}}).union().call(this.finshCallBack).start()}}},{key:"moveRight",value:function(){var e=this;if(this._moveFinsh&&!window._state_magr._gameOver){this._moveFinsh=!1,this.scheduleOnce((function(){this._moveFinsh=!0}),.25);var t=this.node.getPosition();t.z-=1,t.x+=1,this._action=!0,this.player_Body._useGravity=!1,this.player_Body._isKinematic=!0,this.scheduleOnce((function(){this._action=!1,this.player_Body._useGravity=!0,this.player_Body._isKinematic=!1}),.15),n.copy(this._pos,this.node.getPosition()),r(this._pos).to(.1,new n(t.x,1.3,t.z),{easing:"easeIn",onUpdate:function(){e.node.position=e._pos}}).union().start()}}},{key:"finshCallBack",value:function(){console.log("-----------------------完成动作"),this._action=!1}},{key:"update",value:function(e){if(this.node.getPosition().y<=.45&&!window._state_magr._gameOver&&(window._state_magr._gameOver=!0,window._state_magr.emitEvent(window._state_magr.state._gameOver)),this._moveFinsh&&window._state_magr.deleteIndex<=this.node.getPosition().z&&this.node.getPosition().y<=1){var t=this.node.getPosition();t.y-=this._gravity,this._gravity+=.002,this.node.setPosition(t)}}}]),t}(o))||c)),cc._RF.pop()}}})),System.register("project:///assets/scripts/data_con/pool_data.js",["cc"],(function(e,t){var i,o,s,a,n;return e({_dec:void 0,_class:void 0}),{setters:[function(e){i=e._decorator,o=e.Component}],execute:function(){cc._RF.push(window.module||{},"7fb702UOS1Hf5DPTXPNO2KU","pool_data"),n=i.ccclass,i.property,e("pooldata",(s=n("pooldata"),s(a=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"init",value:function(e){if(!this.plane_pool){this.plane_prefab=e,this.plane_pool=new cc.NodePool;for(var t=0;t<20;++t){var i=cc.instantiate(this.plane_prefab);this.plane_pool.put(i)}}}},{key:"getPlaneNode",value:function(){var e=void 0;return(e=this.plane_pool.size()>0?this.plane_pool.get():cc.instantiate(this.plane_prefab)).getComponent("planeNode").init(),e}},{key:"putPlaneNode",value:function(e){this.plane_pool.put(e)}}]),t}(o))||a)),cc._RF.pop()}}})),System.register("project:///assets/scripts/manager/UI_magr.js",["cc"],(function(e,t){var i,o,s,a,n;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,o=e.Component}],execute:function(){cc._RF.push(window.module||{},"d17cfJ16M9PbLJm5SpvBGCV","UI_magr"),n=i.ccclass,i.property,e("UImagr",(s=n("UImagr"),s(a=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(s))))._overView=void 0,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"startLoadRes",value:function(){var e=this;cc.loader.loadRes("prefab/view/overNode",(function(t,i){e._overView=i}))}},{key:"addChildByName",value:function(e){var t=this["_"+e];if(t){var i=cc.instantiate(t);cc.director.getScene().addChild(i)}else console.log("---------------没有找到对应的节点",e)}}]),t}(o))||a)),cc._RF.pop()}}})),System.register("project:///assets/scripts/manager/state_magr.js",["cc"],(function(e,t){var i,o,s,a,n;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,o=e.Component}],execute:function(){cc._RF.push(window.module||{},"203e2SkrGRHC6IjD4gaZQ0O","state_magr"),n=i.ccclass,i.property,e("statemagr",(s=n("statemagr"),s(a=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(s))))._gameOver=!1,i._startGame=!1,i._score=0,i.Notification=null,i.deleteIndex=0,i.state={_gameOver:"gameOver",_againGame:"agameGame"},i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"init",value:function(){this.deleteIndex=-4.5,this._startGame=!1,this._gameOver=!1,this._score=0}},{key:"emitEvent",value:function(e){window.Notification.emit(e)}}]),t}(o))||a)),cc._RF.pop()}}})),System.register("project:///assets/scripts/view/overView.js",["cc"],(function(e,t){var i,o,s,a,n;return e({_dec:void 0,_class:void 0}),{setters:[function(e){i=e._decorator,o=e.Component}],execute:function(){cc._RF.push(window.module||{},"75110Eq3+FBE6nQJSMrW4rp","overView"),n=i.ccclass,i.property,e("overView",(s=n("overView"),s(a=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"againGame",value:function(){window._state_magr.emitEvent(window._state_magr.state._againGame),this.node.destroy()}}]),t}(o))||a)),cc._RF.pop()}}}))}}}));
